## 2026-01-24 - SUM-004
- Implemented SummaryEditor component
- Created packages/ui/src/lib/components/ui/summary-editor/ directory
- Created types.ts, summary-editor.svelte, index.ts
- Implemented features:
  - List of sections (title + content)
  - Edit mode for sections
  - Drag and drop reordering
  - Add/Remove sections
  - Save/Cancel actions
- Added demo route at packages/ui/src/routes/summary-editor/
- Updated PRD to reflect completed status of previous tasks (SUM-002, SUM-003, SUM-005, SUM-006)
- **Learnings for future iterations:**
  - Svelte 5 runes (`$state`, `$props`) are standard; follow this pattern for all new components.
  - `packages/ui` uses alias imports (e.g., `@lib/components/ui/...`) which are resolved at build time.

## 2026-01-29 - VECTOR-001
- Implemented vector search functionality with Docling integration
- Added `documentChunks` table to schema with vector index (1536 dimensions for OpenAI embeddings)
- Extended Docling service with `/chunk` endpoint for text chunking:
  - Sentence-aware chunking (1000 char chunks, 200 char overlap)
  - Section-based chunking preserving document structure
  - Metadata extraction (section titles, page numbers, char positions)
- Created embedding generation workflow (`generateEmbeddings.ts`):
  - OpenAI text-embedding-3-small integration
  - Chunk processing with embedding generation
  - Automatic cleanup of existing chunks on re-processing
- Added document chunk queries (`documentChunks.ts`):
  - List chunks by document
  - Search similar chunks (user-scoped and document-scoped)
  - Delete chunks by document
  - Get chunk count for documents
- Updated schema tests to include new `documentChunks` table (23 tables total)
- Added comprehensive tests for Docling chunking functionality
- Installed @qdrant/js-client-rest package for future Qdrant integration if needed

## 2026-01-29 - VECTOR-002 - OpenAI Integration Testing
- Created comprehensive integration tests for OpenAI text-embedding-3-small:
  - Model: `openai/text-embedding-3-small` via OpenRouter
  - Context: 8,192 tokens
  - Cost: $0.02/M input tokens
  - Dimensions: 1536
- Test coverage includes:
  - **Embedding Generation**: Verify 1536 dimensions, valid numeric values
  - **Consistency**: Same text produces similar embeddings (cosine similarity > 0.99)
  - **Differentiation**: Different texts produce different embeddings (similarity < 0.9)
  - **Semantic Similarity**: Related texts have higher similarity scores (> 0.6)
  - **Semantic Search**: Query matching finds most relevant documents
  - **Edge Cases**: Short text, long text, special characters handled correctly
  - **Embedding Properties**: Normalized embeddings (L2 norm ~1), values in [-1, 1]
- Tests support both OpenAI direct API and OpenRouter integration
- Tests skip gracefully when API keys are not configured
- **LIVE TEST RESULTS** (with OpenRouter API key):
  - All 11 integration tests PASSED
  - Embedding generation: 1536 dimensions confirmed
  - API response time: ~1-2 seconds per request
  - Semantic similarity working correctly
  - Cosine similarity calculations accurate

## 2026-01-30 - FIX-001 - Fix TypeScript Type Errors
- Fixed type mismatch between Better Auth's `user` table and our `users` table:
  - Created `packages/backend/convex/functions/users.ts` with `getCurrentUser` helper
  - Updated `packages/backend/convex/functions/generations.ts` to look up our user by `betterAuthId`
- Fixed convex-svelte usage pattern in frontend pages:
  - Changed from `useMutation()` to `useConvexClient()` + `client.mutation()`
  - Changed from `$query.data` store access to `query.data` direct property access
- Fixed files:
  - `generations/+page.svelte` - List and delete generations
  - `generations/[id]/+page.svelte` - View generation detail with retry
  - `subjects/[id]/+page.svelte` - Create folders and generations
- Build passes successfully with all type errors resolved

